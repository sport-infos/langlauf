
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								
							</style>
                        </head>
                        <body>
                            <!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üá®üá≠ Loipen Finder Schweiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Schneefall Animation */
        .snowflake {
            position: fixed;
            top: -10px;
            z-index: 9999;
            user-select: none;
            cursor: default;
            animation-name: snowfall;
            animation-duration: 10s;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            color: white;
            font-size: 1em;
            opacity: 0.8;
            pointer-events: none;
        }
        
        @keyframes snowfall {
            0% {
                transform: translateY(0vh) translateX(0) rotate(0deg);
            }
            100% {
                transform: translateY(100vh) translateX(30px) rotate(360deg);
            }
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px 25px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2em;
            margin-bottom: 6px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        /* Webcam Section - Originalformat beibehalten */
        .webcam-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .webcam-item {
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            transition: transform 0.3s;
            background: #000;
        }
        
        .webcam-item:hover {
            transform: scale(1.03);
        }
        
        .webcam-item img {
            width: 100%;
            height: auto;
            display: block;
            border: none;
        }
        
        .webcam-item iframe {
            width: 100%;
            height: 150px;
            display: block;
            border: none;
        }
        
        .webcam-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 5px;
            font-size: 0.65em;
            font-weight: 600;
            text-align: center;
        }
        
        /* Loipen Webcam in Card */
        .loipe-webcam {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            margin: 10px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            background: #000;
        }
        
        .loipe-webcam img {
            width: 100%;
            height: auto;
            max-height: 200px;
            object-fit: cover;
            display: block;
        }
        
        .loipe-webcam-label {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .live-indicator {
            width: 8px;
            height: 8px;
            background: #e74c3c;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.3;
            }
        }
        
        .webcam-unavailable {
            padding: 20px;
            text-align: center;
            background: #ecf0f1;
            border-radius: 8px;
            color: #7f8c8d;
            font-size: 0.8em;
            font-style: italic;
        }
        
        /* Stats Bar - sehr kompakt */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            padding: 10px 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .stat-item {
            text-align: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }
        
        .stat-value {
            font-size: 1.3em;
            font-weight: 700;
            color: #3498db;
            display: block;
        }
        
        .stat-label {
            font-size: 0.7em;
            color: #7f8c8d;
            margin-top: 2px;
        }
        
        /* Favoriten Sektion - kompakt */
        .favorites-section {
            padding: 12px 20px;
            background: #fff9e6;
            border-bottom: 2px solid #f39c12;
        }
        
        .favorites-section h2 {
            color: #e67e22;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1.2em;
        }
        
        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 10px;
        }
        
        .favorite-card {
            background: white;
            border: 2px solid #f39c12;
            border-radius: 6px;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .favorite-card:hover {
            transform: translateX(3px);
            box-shadow: 0 3px 10px rgba(243, 156, 18, 0.3);
        }
        
        .favorite-info {
            flex: 1;
        }
        
        .favorite-name {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 3px;
            font-size: 0.85em;
        }
        
        .favorite-location {
            font-size: 0.7em;
            color: #7f8c8d;
        }
        
        .remove-favorite-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
            transition: background 0.3s;
        }
        
        .remove-favorite-btn:hover {
            background: #c0392b;
        }
        
        /* Ultra-kompakte Filter Section */
        .filter-section {
            padding: 12px 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .filter-section h2 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .filter-item {
            background: white;
            padding: 10px;
            border-radius: 6px;
            box-shadow: 0 1px 6px rgba(0,0,0,0.08);
        }
        
        .filter-item label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 6px;
            font-size: 0.75em;
        }
        
        input[type="range"] {
            width: 100%;
            height: 5px;
            border-radius: 3px;
            background: #d3d3d3;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .value-display {
            text-align: center;
            margin-top: 4px;
            font-weight: 600;
            color: #3498db;
            font-size: 0.8em;
        }
        
        .checkbox-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 500;
            cursor: pointer;
            padding: 4px 6px;
            border-radius: 4px;
            transition: background 0.2s;
            font-size: 0.75em;
        }
        
        .checkbox-group label:hover {
            background: #f0f0f0;
        }
        
        input[type="checkbox"] {
            width: 14px;
            height: 14px;
            cursor: pointer;
            accent-color: #3498db;
        }
        
        input[type="text"], select {
            width: 100%;
            padding: 6px 8px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 0.8em;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .region-filter {
            grid-column: 1 / -1;
        }
        
        .region-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }
        
        .region-tag {
            padding: 5px 10px;
            background: #ecf0f1;
            border: 1px solid #bdc3c7;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.75em;
            font-weight: 600;
        }
        
        .region-tag:hover {
            background: #bdc3c7;
        }
        
        .region-tag.active {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .results-section {
            padding: 20px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .results-count {
            font-size: 1.2em;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .sort-controls {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .sort-controls label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.85em;
        }
        
        .loipen-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 18px;
        }
        
        .loipe-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 18px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .loipe-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #3498db, #2ecc71);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .loipe-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
            border-color: #3498db;
        }
        
        .loipe-card:hover::before {
            opacity: 1;
        }
        
        .loipe-card.favorite {
            border-color: #f39c12;
            background: #fffef7;
        }
        
        .loipe-header {
            margin-bottom: 10px;
            position: relative;
        }
        
        .favorite-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            background: transparent;
            border: none;
            font-size: 1.6em;
            cursor: pointer;
            transition: transform 0.2s;
            padding: 4px;
            z-index: 10;
        }
        
        .favorite-btn:hover {
            transform: scale(1.15);
        }
        
        .favorite-btn.active {
            filter: drop-shadow(0 0 6px rgba(243, 156, 18, 0.8));
        }
        
        .loipe-name {
            font-size: 1.2em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
            line-height: 1.3;
            padding-right: 35px;
        }
        
        .loipe-link {
            color: #3498db;
            text-decoration: none;
            font-size: 0.75em;
            display: inline-flex;
            align-items: center;
            gap: 3px;
            margin-bottom: 6px;
        }
        
        .loipe-link:hover {
            text-decoration: underline;
        }
        
        .loipe-location {
            color: #7f8c8d;
            font-size: 0.85em;
            margin-bottom: 3px;
        }
        
        .region-badge {
            display: inline-block;
            padding: 2px 6px;
            background: #9b59b6;
            color: white;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: 600;
            margin-top: 3px;
        }
        
        .last-update {
            color: #95a5a6;
            font-size: 0.75em;
            font-style: italic;
        }
        
        /* Navigation Box - kompakter */
        .navigation-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .nav-title {
            font-weight: 700;
            font-size: 0.9em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .nav-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .nav-item {
            background: rgba(255,255,255,0.2);
            padding: 8px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .nav-icon {
            font-size: 1.2em;
        }
        
        .nav-value {
            display: flex;
            flex-direction: column;
        }
        
        .nav-label {
            font-size: 0.65em;
            opacity: 0.9;
        }
        
        .nav-number {
            font-size: 1.1em;
            font-weight: 700;
        }
        
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }
        
        .nav-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.8em;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            text-decoration: none;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            background: #f0f0f0;
        }
        
        .nav-btn.primary {
            background: #2ecc71;
            color: white;
        }
        
        .nav-btn.primary:hover {
            background: #27ae60;
        }
        
        /* Wetter Widget - kompakter */
        .weather-widget {
            background: linear-gradient(135deg, #5fc3e4 0%, #e55d87 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .weather-current {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.3);
        }
        
        .weather-temp {
            font-size: 2em;
            font-weight: 700;
        }
        
        .weather-icon {
            font-size: 2.2em;
        }
        
        .weather-info {
            font-size: 0.8em;
            opacity: 0.95;
        }
        
        .weather-forecast {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 8px;
        }
        
        .forecast-day {
            text-align: center;
            padding: 5px 2px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            font-size: 0.65em;
        }
        
        .forecast-date {
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .forecast-icon {
            font-size: 1.4em;
            margin: 3px 0;
        }
        
        .forecast-temp {
            font-weight: 600;
        }
        
        .forecast-snow {
            color: #e8f8ff;
            font-size: 0.75em;
            margin-top: 2px;
        }
        
        .nebel-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin-top: 6px;
        }
        
        .nebel-√ºber {
            background: #2ecc71;
            color: white;
        }
        
        .nebel-unter {
            background: #95a5a6;
            color: white;
        }
        
        .nebel-im {
            background: #7f8c8d;
            color: white;
        }
        
        .weather-loading {
            text-align: center;
            padding: 12px;
            color: white;
            font-style: italic;
            font-size: 0.8em;
        }
        
        /* Schneeh√∂he Anzeige */
        .schneehoehe-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 8px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.8em;
            border: 2px solid #2196f3;
        }
        
        .schneehoehe-box strong {
            display: block;
            margin-bottom: 5px;
            color: #1976d2;
        }
        
        .schnee-detail {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
        }
        
        .loipe-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 12px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8em;
        }
        
        .detail-icon {
            font-size: 1.1em;
            width: 20px;
            text-align: center;
        }
        
        .detail-value {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .hoehenprofil-box {
            background: #ecf0f1;
            padding: 8px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.8em;
        }
        
        .hoehenprofil-box strong {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .hoehen-detail {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin: 3px 3px 3px 0;
        }
        
        .status-gut {
            background: #2ecc71;
            color: white;
        }
        
        .status-mittel {
            background: #f39c12;
            color: white;
        }
        
        .status-schlecht {
            background: #e74c3c;
            color: white;
        }
        
        .status-unbekannt {
            background: #95a5a6;
            color: white;
        }
        
        .technik-badges {
            display: flex;
            gap: 5px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        
        .technik-badge {
            padding: 3px 8px;
            background: #3498db;
            color: white;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: 600;
        }
        
        .difficulty-leicht {
            background: #2ecc71;
        }
        
        .difficulty-mittel {
            background: #f39c12;
        }
        
        .difficulty-schwer {
            background: #e74c3c;
        }
        
        .beschreibung {
            font-size: 0.8em;
            color: #555;
            line-height: 1.4;
            margin: 8px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }
        
        .besonderheiten {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 8px;
        }
        
        .besonderheit-tag {
            padding: 2px 6px;
            background: #ecf0f1;
            border-radius: 8px;
            font-size: 0.65em;
            color: #2c3e50;
        }
        
        .no-results {
            text-align: center;
            padding: 50px 20px;
            color: #7f8c8d;
        }
        
        .no-results h3 {
            font-size: 1.6em;
            margin-bottom: 10px;
        }
        
        button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        @media (max-width: 1024px) {
            .webcam-section {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .loipen-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .favorites-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.6em;
            }
            
            .loipe-details {
                grid-template-columns: 1fr;
            }
            
            .weather-forecast {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .nav-details {
                grid-template-columns: 1fr;
            }
            
            .nav-buttons {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üá®üá≠ Loipen Finder Schweiz</h1>
            <p>Langlaufloipen mit Live-Wetter, Navigation & Favoriten</p>
            
            <!-- Live Webcams -->
            <div class="webcam-section">
                <div class="webcam-item">
                    <img src="https://lws-sport.ch/webcam/lwscam.jpg" alt="LWS Sport Webcam" loading="lazy">
                    <div class="webcam-label">üìπ LWS Sport</div>
                </div>
                <div class="webcam-item">
                    <img src="https://lws-sport.ch/webcamrandenhaus/randenhauscam.jpg" alt="Randenhaus Webcam" loading="lazy">
                    <div class="webcam-label">üìπ Randenhaus</div>
                </div>
                <div class="webcam-item">
                    <iframe src="https://hagenturm.roundshot.com/#/" title="Hagenturm Panorama" loading="lazy"></iframe>
                    <div class="webcam-label">üìπ Hagenturm</div>
                </div>
            </div>
        </header>
        
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-value" id="total-loipen">0</span>
                <span class="stat-label">Loipen</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="total-km">0</span>
                <span class="stat-label">Kilometer</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="total-regionen">0</span>
                <span class="stat-label">Regionen</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="favorites-count">0</span>
                <span class="stat-label">‚≠ê Favoriten</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="avg-distance">0</span>
                <span class="stat-label">√ò Anfahrt</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="last-update">-</span>
                <span class="stat-label">Update</span>
            </div>
        </div>
        
        <!-- Favoriten Sektion -->
        <div class="favorites-section" id="favorites-section" style="display: none;">
            <h2>‚≠ê Favoriten</h2>
            <div class="favorites-grid" id="favorites-container"></div>
        </div>
        
        <div class="filter-section">
            <h2>üîç Filter</h2>
            
            <div class="filter-grid">
                <div class="filter-item region-filter">
                    <label>üèîÔ∏è Regionen</label>
                    <div class="region-tags" id="region-tags"></div>
                </div>
                
                <div class="filter-item">
                    <label>üìç PLZ</label>
                    <input type="text" id="plz-input" value="8824" placeholder="z.B. 8824">
                </div>
                
                <div class="filter-item">
                    <label>üìè Loipen-Distanz</label>
                    <input type="range" id="distanz-slider" min="0" max="50" value="50" step="1">
                    <div class="value-display">0 - <span id="distanz-value">50</span> km</div>
                </div>
                
                <div class="filter-item">
                    <label>üöó Max. Anfahrt</label>
                    <input type="range" id="anfahrt-slider" min="0" max="300" value="100" step="5">
                    <div class="value-display">0 - <span id="anfahrt-value">100</span> km</div>
                </div>
                
                <div class="filter-item">
                    <label>‚õ∞Ô∏è H√∂henmeter</label>
                    <input type="range" id="hoehenmeter-slider" min="0" max="1000" value="1000" step="50">
                    <div class="value-display">0 - <span id="hoehenmeter-value">1000</span> Hm</div>
                </div>
                
                <div class="filter-item">
                    <label>üìÖ Update (Tage)</label>
                    <input type="range" id="update-slider" min="1" max="30" value="2" step="1">
                    <div class="value-display"><span id="update-value">2</span> Tage</div>
                </div>
                
                <div class="filter-item">
                    <label>‚ùÑÔ∏è Min. Schneeh√∂he</label>
                    <input type="range" id="schnee-slider" min="0" max="200" value="0" step="10">
                    <div class="value-display"><span id="schnee-value">0</span> cm</div>
                </div>
                
                <div class="filter-item">
                    <label>üå§Ô∏è Wetterprognose</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="wetter-sonnig" checked>
                            Sonnig
                        </label>
                        <label>
                            <input type="checkbox" id="wetter-schnee" checked>
                            Schnee
                        </label>
                        <label>
                            <input type="checkbox" id="wetter-bewoelkt" checked>
                            Bew√∂lkt
                        </label>
                    </div>
                </div>
                
                <div class="filter-item">
                    <label>‚õ∑Ô∏è Technik</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="klassisch" checked>
                            Klassisch
                        </label>
                        <label>
                            <input type="checkbox" id="skating" checked>
                            Skating
                        </label>
                    </div>
                </div>
                
                <div class="filter-item">
                    <label>‚úÖ Zustand</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="gut" checked>
                            Gut
                        </label>
                        <label>
                            <input type="checkbox" id="mittel" checked>
                            Mittel
                        </label>
                        <label>
                            <input type="checkbox" id="geschlossen">
                            Zu
                        </label>
                    </div>
                </div>
                
                <div class="filter-item">
                    <label>üéØ Schwierigkeit</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="schwier-leicht" checked>
                            Leicht
                        </label>
                        <label>
                            <input type="checkbox" id="schwier-mittel" checked>
                            Mittel
                        </label>
                        <label>
                            <input type="checkbox" id="schwier-schwer" checked>
                            Schwer
                        </label>
                    </div>
                </div>
                
                <div class="filter-item">
                    <label>üî§ Suche</label>
                    <input type="text" id="search-input" placeholder="Name/Ort...">
                </div>
            </div>
        </div>
        
        <div class="results-section">
            <div class="results-header">
                <div class="results-count">
                    <span id="results-count">0</span> Loipen
                </div>
                <div class="sort-controls">
                    <label for="sort-select">Sortieren:</label>
                    <select id="sort-select">
                        <option value="name">Name</option>
                        <option value="anfahrt">Anfahrt</option>
                        <option value="distanz">Distanz</option>
                        <option value="hoehe">H√∂henmeter</option>
                        <option value="region">Region</option>
                        <option value="update">Update</option>
                    </select>
                    <button onclick="window.loipenApp.loadData()">üîÑ</button>
                    <button onclick="window.loipenApp.exportFavorites()">üì•</button>
                </div>
            </div>
            
            <div class="loipen-grid" id="loipen-container"></div>
            
            <div class="no-results" id="no-results" style="display: none;">
                <h3>üòî Keine Loipen gefunden</h3>
                <p>Filter anpassen</p>
            </div>
        </div>
    </div>
    
    <script>
        // ====================================
        // WEBCAM DATABASE
        // ====================================
        const WEBCAM_DATABASE = {
            // Graub√ºnden
            'arosa': 'https://www.arosa.swiss/webcams/arosa-innerarosa/',
            'davos': 'https://www.davos.ch/sommer/service/webcams/',
            'flims': 'https://www.flims.com/de/webcams',
            'st. moritz': 'https://www.engadin.stmoritz.ch/winter/de/webcams/',
            'lenzerheide': 'https://www.lenzerheide.com/de/informationen/webcams',
            
            // Bern
            'gstaad': 'https://www.gstaad.ch/de/winter/webcams/',
            'adelboden': 'https://www.adelboden.ch/de/webcams',
            'kandersteg': 'https://www.kandersteg.ch/de/winter/webcams',
            
            // Wallis
            'zermatt': 'https://www.zermatt.ch/de/Media/Webcams',
            'saas-fee': 'https://www.saas-fee.ch/de/webcams/',
            
            // Zentralschweiz
            'engelberg': 'https://www.engelberg.ch/de/winter/webcams/',
            'andermatt': 'https://www.andermatt.ch/de/Winter/Webcams',
            
            // Ostschweiz
            'wildhaus': 'https://www.wildhaus.ch/de/winter/service-info/webcams',
            'appenzell': 'https://www.appenzell.ch/de/erleben/webcams.html',
            
            // Andere
            'la chaux-de-fonds': 'https://www.j3l.ch/de/webcams-P26803',
            'les diablerets': 'https://www.diablerets.ch/de/S106/webcams'
        };
        
        // ====================================
        // SCHNEEFALL ANIMATION
        // ====================================
        function createSnowflakes() {
            const snowflakeCount = 50;
            const snowflakes = ['‚ùÑ', '‚ùÖ', '‚ùÜ'];
            
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.innerHTML = snowflakes[Math.floor(Math.random() * snowflakes.length)];
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.animationDuration = (Math.random() * 3 + 7) + 's';
                snowflake.style.animationDelay = Math.random() * 5 + 's';
                snowflake.style.fontSize = (Math.random() * 10 + 10) + 'px';
                snowflake.style.opacity = Math.random() * 0.6 + 0.4;
                
                document.body.appendChild(snowflake);
            }
        }
        
        // ====================================
        // MOCK DATA GENERATOR mit Schneeh√∂hen & Webcams
        // ====================================
        function generateMockLoipenData() {
            const today = new Date();
            const loipen = [
                {
                    name: "Rinerhorn Panoramaloipe",
                    ort: "7050 Arosa",
                    plz: "7050",
                    distanz_km: 12.5,
                    zustand: "Gut gespurt",
                    technik: ["Klassisch", "Skating"],
                    anfahrt_km: 85,
                    hoehenmeter: 150,
                    schneehoehe: 85,
                    webcam_url: 'https://www.arosa.swiss/webcams/arosa-innerarosa/',
                    link: "https://www.bergfex.ch/arosa/langlaufen/",
                    letztes_update: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1800,
                        max_hoehe: 1950,
                        aufstieg: 150,
                        abstieg: 150
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Wundersch√∂ne Panoramaloipe mit herrlicher Aussicht auf die Aroser Bergwelt.",
                    besonderheiten: ["Beschneiung", "Beleuchtung", "Hundeloipe"],
                    region: "Graub√ºnden",
                    latitude: 46.7833,
                    longitude: 9.6833
                },
                {
                    name: "Jakobshorn H√∂henloipe",
                    ort: "7270 Davos",
                    plz: "7270",
                    distanz_km: 8.3,
                    zustand: "Gut",
                    technik: ["Klassisch"],
                    anfahrt_km: 95,
                    hoehenmeter: 80,
                    schneehoehe: 120,
                    webcam_url: 'https://www.davos.ch/sommer/service/webcams/',
                    link: "https://www.bergfex.ch/davos/langlaufen/",
                    letztes_update: new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1560,
                        max_hoehe: 1640,
                        aufstieg: 80,
                        abstieg: 80
                    },
                    schwierigkeit: "Leicht",
                    beschreibung: "Ideale Einsteigerloipe mit sanften Steigungen.",
                    besonderheiten: ["Anf√§ngerfreundlich", "Parkpl√§tze"],
                    region: "Graub√ºnden",
                    latitude: 46.8028,
                    longitude: 9.8361
                },
                {
                    name: "Flims Waldloipe",
                    ort: "7017 Flims",
                    plz: "7017",
                    distanz_km: 15.0,
                    zustand: "Mittel",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 65,
                    hoehenmeter: 200,
                    schneehoehe: 45,
                    webcam_url: 'https://www.flims.com/de/webcams',
                    link: "https://www.bergfex.ch/flims/langlaufen/",
                    letztes_update: new Date(today.getTime() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1100,
                        max_hoehe: 1300,
                        aufstieg: 200,
                        abstieg: 200
                    },
                    schwierigkeit: "Schwer",
                    beschreibung: "Anspruchsvolle Waldloipe durch herrliche Natur.",
                    besonderheiten: ["Wettkampfstrecke", "FIS"],
                    region: "Graub√ºnden",
                    latitude: 46.8333,
                    longitude: 9.2833
                },
                {
                    name: "Engadin Marathon Strecke",
                    ort: "7500 St. Moritz",
                    plz: "7500",
                    distanz_km: 42.0,
                    zustand: "Gut gespurt",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 145,
                    hoehenmeter: 350,
                    schneehoehe: 150,
                    webcam_url: 'https://www.engadin.stmoritz.ch/winter/de/webcams/',
                    link: "https://www.bergfex.ch/engadin/langlaufen/",
                    letztes_update: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1600,
                        max_hoehe: 1950,
                        aufstieg: 350,
                        abstieg: 350
                    },
                    schwierigkeit: "Schwer",
                    beschreibung: "Die legend√§re Engadin Marathon Strecke.",
                    besonderheiten: ["Marathon", "Weltcup"],
                    region: "Graub√ºnden",
                    latitude: 46.4969,
                    longitude: 9.8355
                },
                {
                    name: "Lenzerheide Rundloipe",
                    ort: "7078 Lenzerheide",
                    plz: "7078",
                    distanz_km: 10.5,
                    zustand: "Gut",
                    technik: ["Klassisch", "Skating"],
                    anfahrt_km: 78,
                    hoehenmeter: 120,
                    schneehoehe: 95,
                    webcam_url: 'https://www.lenzerheide.com/de/informationen/webcams',
                    link: "https://www.bergfex.ch/lenzerheide/langlaufen/",
                    letztes_update: new Date(today.getTime() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1450,
                        max_hoehe: 1570,
                        aufstieg: 120,
                        abstieg: 120
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Abwechslungsreiche Rundloipe mit Seeblick.",
                    besonderheiten: ["Seeblick", "Restaurant"],
                    region: "Graub√ºnden",
                    latitude: 46.7167,
                    longitude: 9.5667
                },
                {
                    name: "Gstaad H√∂henloipe",
                    ort: "3780 Gstaad",
                    plz: "3780",
                    distanz_km: 18.0,
                    zustand: "Gut gespurt",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 125,
                    hoehenmeter: 250,
                    schneehoehe: 110,
                    webcam_url: 'https://www.gstaad.ch/de/winter/webcams/',
                    link: "https://www.bergfex.ch/gstaad/langlaufen/",
                    letztes_update: new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1100,
                        max_hoehe: 1350,
                        aufstieg: 250,
                        abstieg: 250
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Sonnige H√∂henloipe mit Alpenpanorama.",
                    besonderheiten: ["Sonnig", "Panorama"],
                    region: "Bern",
                    latitude: 46.4750,
                    longitude: 7.2867
                },
                {
                    name: "Adelboden Dorfloipe",
                    ort: "3715 Adelboden",
                    plz: "3715",
                    distanz_km: 7.5,
                    zustand: "Gut",
                    technik: ["Klassisch"],
                    anfahrt_km: 110,
                    hoehenmeter: 60,
                    schneehoehe: 75,
                    webcam_url: 'https://www.adelboden.ch/de/webcams',
                    link: "https://www.bergfex.ch/adelboden/langlaufen/",
                    letztes_update: new Date(today.getTime() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1320,
                        max_hoehe: 1380,
                        aufstieg: 60,
                        abstieg: 60
                    },
                    schwierigkeit: "Leicht",
                    beschreibung: "Gem√ºtliche Dorfloipe f√ºr Familien.",
                    besonderheiten: ["Familie", "Dorfn√§he"],
                    region: "Bern",
                    latitude: 46.4925,
                    longitude: 7.5597
                },
                {
                    name: "Kandersteg Nordische Meile",
                    ort: "3718 Kandersteg",
                    plz: "3718",
                    distanz_km: 14.0,
                    zustand: "Mittel",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 115,
                    hoehenmeter: 180,
                    schneehoehe: 55,
                    webcam_url: 'https://www.kandersteg.ch/de/winter/webcams',
                    link: "https://www.bergfex.ch/kandersteg/langlaufen/",
                    letztes_update: new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1170,
                        max_hoehe: 1350,
                        aufstieg: 180,
                        abstieg: 180
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Loipe durch das UNESCO Weltnaturerbe.",
                    besonderheiten: ["UNESCO", "Naturpark"],
                    region: "Bern",
                    latitude: 46.4875,
                    longitude: 7.6686
                },
                {
                    name: "Zermatt H√∂henweg",
                    ort: "3920 Zermatt",
                    plz: "3920",
                    distanz_km: 9.0,
                    zustand: "Gut gespurt",
                    technik: ["Skating"],
                    anfahrt_km: 165,
                    hoehenmeter: 100,
                    schneehoehe: 180,
                    webcam_url: 'https://www.zermatt.ch/de/Media/Webcams',
                    link: "https://www.bergfex.ch/zermatt/langlaufen/",
                    letztes_update: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1620,
                        max_hoehe: 1720,
                        aufstieg: 100,
                        abstieg: 100
                    },
                    schwierigkeit: "Leicht",
                    beschreibung: "Spektakul√§re Loipe mit Matterhorn-Blick.",
                    besonderheiten: ["Matterhorn", "Hochalpin"],
                    region: "Wallis",
                    latitude: 46.0207,
                    longitude: 7.7491
                },
                {
                    name: "Saas-Fee Gletscherloipe",
                    ort: "3906 Saas-Fee",
                    plz: "3906",
                    distanz_km: 11.5,
                    zustand: "Gut",
                    technik: ["Klassisch", "Skating"],
                    anfahrt_km: 170,
                    hoehenmeter: 140,
                    schneehoehe: 200,
                    webcam_url: 'https://www.saas-fee.ch/de/webcams/',
                    link: "https://www.bergfex.ch/saas-fee/langlaufen/",
                    letztes_update: new Date(today.getTime() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1800,
                        max_hoehe: 1940,
                        aufstieg: 140,
                        abstieg: 140
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Hochalpine Loipe umgeben von 4000ern.",
                    besonderheiten: ["Gletscher", "4000er"],
                    region: "Wallis",
                    latitude: 46.1097,
                    longitude: 7.9286
                },
                {
                    name: "Engelberg Gerschnialp",
                    ort: "6390 Engelberg",
                    plz: "6390",
                    distanz_km: 13.0,
                    zustand: "Gut gespurt",
                    technik: ["Klassisch", "Skating"],
                    anfahrt_km: 92,
                    hoehenmeter: 170,
                    schneehoehe: 105,
                    webcam_url: 'https://www.engelberg.ch/de/winter/webcams/',
                    link: "https://www.bergfex.ch/engelberg/langlaufen/",
                    letztes_update: new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1250,
                        max_hoehe: 1420,
                        aufstieg: 170,
                        abstieg: 170
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Abwechslungsreiche Loipe mit Klosterblick.",
                    besonderheiten: ["Kloster", "Bergbahn"],
                    region: "Zentralschweiz",
                    latitude: 46.8233,
                    longitude: 8.4050
                },
                {
                    name: "Andermatt Realp",
                    ort: "6490 Andermatt",
                    plz: "6490",
                    distanz_km: 16.0,
                    zustand: "Mittel",
                    technik: ["Klassisch"],
                    anfahrt_km: 88,
                    hoehenmeter: 220,
                    schneehoehe: 65,
                    webcam_url: 'https://www.andermatt.ch/de/Winter/Webcams',
                    link: "https://www.bergfex.ch/andermatt/langlaufen/",
                    letztes_update: new Date(today.getTime() - 6 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1440,
                        max_hoehe: 1660,
                        aufstieg: 220,
                        abstieg: 220
                    },
                    schwierigkeit: "Schwer",
                    beschreibung: "Anspruchsvolle Strecke durch das Urserental.",
                    besonderheiten: ["Hochtal", "Wildromantisch"],
                    region: "Zentralschweiz",
                    latitude: 46.6333,
                    longitude: 8.5944
                },
                {
                    name: "Wildhaus Gampl√ºt",
                    ort: "9658 Wildhaus",
                    plz: "9658",
                    distanz_km: 8.0,
                    zustand: "Gut",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 52,
                    hoehenmeter: 90,
                    schneehoehe: 30,
                    webcam_url: 'https://www.wildhaus.ch/de/winter/service-info/webcams',
                    link: "https://www.bergfex.ch/wildhaus/langlaufen/",
                    letztes_update: new Date(today.getTime() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1080,
                        max_hoehe: 1170,
                        aufstieg: 90,
                        abstieg: 90
                    },
                    schwierigkeit: "Leicht",
                    beschreibung: "Sonnige Panoramaloipe im Toggenburg.",
                    besonderheiten: ["Sonnig", "Aussicht"],
                    region: "Ostschweiz",
                    latitude: 47.2019,
                    longitude: 9.3489
                },
                {
                    name: "Appenzell Hochmoor",
                    ort: "9050 Appenzell",
                    plz: "9050",
                    distanz_km: 6.5,
                    zustand: "Gut gespurt",
                    technik: ["Klassisch"],
                    anfahrt_km: 45,
                    hoehenmeter: 50,
                    schneehoehe: 25,
                    webcam_url: 'https://www.appenzell.ch/de/erleben/webcams.html',
                    link: "https://www.bergfex.ch/appenzell/langlaufen/",
                    letztes_update: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 780,
                        max_hoehe: 830,
                        aufstieg: 50,
                        abstieg: 50
                    },
                    schwierigkeit: "Leicht",
                    beschreibung: "Gem√ºtliche Loipe durch Appenzeller Landschaft.",
                    besonderheiten: ["Kulturlandschaft", "Dorf"],
                    region: "Ostschweiz",
                    latitude: 47.3319,
                    longitude: 9.4094
                },
                {
                    name: "La Chaux-de-Fonds M√©tropole",
                    ort: "2300 La Chaux-de-Fonds",
                    plz: "2300",
                    distanz_km: 20.0,
                    zustand: "Gut",
                    technik: ["Skating", "Klassisch"],
                    anfahrt_km: 98,
                    hoehenmeter: 180,
                    schneehoehe: 40,
                    webcam_url: 'https://www.j3l.ch/de/webcams-P26803',
                    link: "https://www.bergfex.ch/jura/langlaufen/",
                    letztes_update: new Date(today.getTime() - 4 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 1000,
                        max_hoehe: 1180,
                        aufstieg: 180,
                        abstieg: 180
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "Weitl√§ufiges Loipennetz im Jura.",
                    besonderheiten: ["Weitl√§ufig", "Netz"],
                    region: "Jura",
                    latitude: 47.0993,
                    longitude: 6.8269
                },
                {
                    name: "Les Diablerets Glacier 3000",
                    ort: "1865 Les Diablerets",
                    plz: "1865",
                    distanz_km: 5.0,
                    zustand: "Gut gespurt",
                    technik: ["Skating"],
                    anfahrt_km: 145,
                    hoehenmeter: 80,
                    schneehoehe: 250,
                    webcam_url: 'https://www.diablerets.ch/de/S106/webcams',
                    link: "https://www.bergfex.ch/diablerets/langlaufen/",
                    letztes_update: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    hoehenprofil: {
                        min_hoehe: 2920,
                        max_hoehe: 3000,
                        aufstieg: 80,
                        abstieg: 80
                    },
                    schwierigkeit: "Mittel",
                    beschreibung: "H√∂chstgelegene Loipe der Schweiz!",
                    besonderheiten: ["Gletscher", "3000m"],
                    region: "Waadt",
                    latitude: 46.3525,
                    longitude: 7.2042
                }
            ];
            
            return {
                scraping_datum: new Date().toISOString(),
                quelle: "Demo-Daten",
                statistiken: {
                    anzahl_total: loipen.length,
                    mit_details: loipen.length,
                    mit_hoehenprofil: loipen.length,
                    mit_anfahrt: loipen.length,
                    mit_koordinaten: loipen.length,
                    regionen: {}
                },
                loipen: loipen
            };
        }
        
        // ====================================
        // HAUPTANWENDUNG
        // ====================================
        
        window.loipenApp = {
            loipenData: [],
            filteredData: [],
            activeRegions: new Set(),
            favorites: new Set(),
            weatherCache: {},
            
            WEATHER_API_URL: 'https://api.open-meteo.com/v1/forecast',
            NEBELGRENZE: 1200,
            
            calculateTravelTime(distanceKm) {
                if (!distanceKm) return null;
                const avgSpeed = 60;
                const hours = distanceKm / avgSpeed;
                const minutes = Math.round(hours * 60);
                if (minutes < 60) {
                    return `${minutes} Min`;
                } else {
                    const h = Math.floor(minutes / 60);
                    const m = minutes % 60;
                    return m > 0 ? `${h}h ${m}min` : `${h}h`;
                }
            },
            
            generateGoogleMapsLink(loipe, startPLZ = '8824') {
                if (!loipe.latitude || !loipe.longitude) {
                    const destination = encodeURIComponent(`${loipe.ort}, Schweiz`);
                    return `https://www.google.com/maps/dir/?api=1&destination=${destination}&travelmode=driving`;
                }
                const origin = encodeURIComponent(`${startPLZ}, Schweiz`);
                const destination = `${loipe.latitude},${loipe.longitude}`;
                return `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${destination}&travelmode=driving`;
            },
            
            generateAppleMapsLink(loipe, startPLZ = '8824') {
                if (!loipe.latitude || !loipe.longitude) {
                    const destination = encodeURIComponent(`${loipe.ort}, Schweiz`);
                    return `http://maps.apple.com/?daddr=${destination}&dirflg=d`;
                }
                return `http://maps.apple.com/?daddr=${loipe.latitude},${loipe.longitude}&dirflg=d`;
            },
            
            // Webcam-Widget f√ºr Loipe erstellen
            createWebcamWidget(loipe) {
                if (!loipe.webcam_url) {
                    return '';
                }
                
                // Versuche, Ort zu extrahieren f√ºr Webcam-Suche
                const ortLower = loipe.ort.toLowerCase();
                
                // Pr√ºfe ob es eine direkte Webcam-URL gibt
                return `
                    <div class="loipe-webcam">
                        <a href="${loipe.webcam_url}" target="_blank" style="position: relative; display: block;">
                            <div class="loipe-webcam-label">
                                <span class="live-indicator"></span>
                                üìπ Live Webcam
                            </div>
                            <div class="webcam-unavailable">
                                üé• Klicken f√ºr Live-Webcam<br>
                                <small>${loipe.ort}</small>
                            </div>
                        </a>
                    </div>
                `;
            },
            
            loadFavorites() {
                const saved = localStorage.getItem('loipen_favorites');
                if (saved) {
                    this.favorites = new Set(JSON.parse(saved));
                }
                this.updateFavoritesDisplay();
            },
            
            saveFavorites() {
                localStorage.setItem('loipen_favorites', JSON.stringify([...this.favorites]));
                this.updateFavoritesDisplay();
            },
            
            toggleFavorite(loipeId) {
                if (this.favorites.has(loipeId)) {
                    this.favorites.delete(loipeId);
                } else {
                    this.favorites.add(loipeId);
                }
                this.saveFavorites();
                this.filterLoipen();
            },
            
            updateFavoritesDisplay() {
                const section = document.getElementById('favorites-section');
                const container = document.getElementById('favorites-container');
                const countDisplay = document.getElementById('favorites-count');
                
                countDisplay.textContent = this.favorites.size;
                
                if (this.favorites.size === 0) {
                    section.style.display = 'none';
                    return;
                }
                
                section.style.display = 'block';
                
                const favoriteLoipen = this.loipenData.filter(l => 
                    this.favorites.has(this.getLoipeId(l))
                );
                
                container.innerHTML = favoriteLoipen.map(loipe => `
                    <div class="favorite-card">
                        <div class="favorite-info">
                            <div class="favorite-name">${loipe.name}</div>
                            <div class="favorite-location">üìç ${loipe.ort} ‚Ä¢ ${loipe.distanz_km} km</div>
                        </div>
                        <button class="remove-favorite-btn" data-loipe-id="${this.getLoipeId(loipe)}">
                            ‚úï
                        </button>
                    </div>
                `).join('');
                
                container.querySelectorAll('.remove-favorite-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const loipeId = e.target.getAttribute('data-loipe-id');
                        this.toggleFavorite(loipeId);
                    });
                });
            },
            
            getLoipeId(loipe) {
                return `${loipe.name}_${loipe.ort}`.replace(/[^a-zA-Z0-9]/g, '_');
            },
            
            exportFavorites() {
                const favoriteLoipen = this.loipenData.filter(l => 
                    this.favorites.has(this.getLoipeId(l))
                );
                
                if (favoriteLoipen.length === 0) {
                    alert('Keine Favoriten vorhanden!');
                    return;
                }
                
                const exportData = {
                    exportiert_am: new Date().toISOString(),
                    anzahl: favoriteLoipen.length,
                    favoriten: favoriteLoipen
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `loipen_favoriten_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                URL.revokeObjectURL(url);
            },
            
            async getWeatherData(latitude, longitude) {
                const cacheKey = `${latitude.toFixed(2)}_${longitude.toFixed(2)}`;
                
                if (this.weatherCache[cacheKey]) {
                    const age = Date.now() - this.weatherCache[cacheKey].timestamp;
                    if (age < 5 * 60 * 1000) {
                        return this.weatherCache[cacheKey].data;
                    }
                }
                
                try {
                    const url = `${this.WEATHER_API_URL}?latitude=${latitude}&longitude=${longitude}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,snowfall_sum,weathercode&current_weather=true&timezone=Europe/Zurich`;
                    
                    const response = await fetch(url);
                    const data = await response.json();
                    
                    this.weatherCache[cacheKey] = {
                        timestamp: Date.now(),
                        data: data
                    };
                    
                    return data;
                } catch (error) {
                    console.error('Wetter-API Fehler:', error);
                    return null;
                }
            },
            
            getWeatherIcon(code) {
                const icons = {
                    0: '‚òÄÔ∏è', 1: 'üå§Ô∏è', 2: '‚õÖ', 3: '‚òÅÔ∏è',
                    45: 'üå´Ô∏è', 48: 'üå´Ô∏è', 51: 'üå¶Ô∏è', 53: 'üå¶Ô∏è',
                    55: 'üåßÔ∏è', 61: 'üåßÔ∏è', 63: 'üåßÔ∏è', 65: 'üåßÔ∏è',
                    71: 'üå®Ô∏è', 73: 'üå®Ô∏è', 75: '‚ùÑÔ∏è', 77: 'üå®Ô∏è',
                    80: 'üå¶Ô∏è', 81: 'üåßÔ∏è', 82: '‚õàÔ∏è', 85: 'üå®Ô∏è',
                    86: '‚ùÑÔ∏è', 95: '‚õàÔ∏è', 96: '‚õàÔ∏è', 99: '‚õàÔ∏è'
                };
                return icons[code] || 'üå°Ô∏è';
            },
            
            categorizeWeather(weathercode) {
                if ([0, 1].includes(weathercode)) return 'sonnig';
                if ([71, 73, 75, 77, 85, 86].includes(weathercode)) return 'schnee';
                return 'bewoelkt';
            },
            
            getNebelStatus(hoehe) {
                if (!hoehe) return null;
                
                if (hoehe > this.NEBELGRENZE + 200) {
                    return { text: '‚òÄÔ∏è √úber Nebel', class: 'nebel-√ºber' };
                } else if (hoehe < this.NEBELGRENZE - 200) {
                    return { text: 'üå´Ô∏è Unter Nebel', class: 'nebel-unter' };
                } else {
                    return { text: 'üò∂‚Äçüå´Ô∏è Im Nebel', class: 'nebel-im' };
                }
            },
            
            async createWeatherWidget(loipe) {
                if (!loipe.latitude || !loipe.longitude) {
                    return '<div class="weather-loading">Keine Koordinaten</div>';
                }
                
                const weather = await this.getWeatherData(loipe.latitude, loipe.longitude);
                
                if (!weather || !weather.current_weather) {
                    return '<div class="weather-loading">Wetter nicht verf√ºgbar</div>';
                }
                
                const current = weather.current_weather;
                const daily = weather.daily;
                
                loipe.wetter_kategorie = this.categorizeWeather(current.weathercode);
                
                const mittlereHoehe = loipe.hoehenprofil?.max_hoehe || 
                                     loipe.hoehenprofil?.min_hoehe || 1500;
                const nebelStatus = this.getNebelStatus(mittlereHoehe);
                
                const forecastHTML = daily.time.slice(0, 7).map((date, idx) => {
                    const dateObj = new Date(date);
                    const dayName = dateObj.toLocaleDateString('de-CH', { weekday: 'short' });
                    const maxTemp = Math.round(daily.temperature_2m_max[idx]);
                    const minTemp = Math.round(daily.temperature_2m_min[idx]);
                    const snow = daily.snowfall_sum[idx] || 0;
                    const icon = this.getWeatherIcon(daily.weathercode[idx]);
                    
                    return `
                        <div class="forecast-day">
                            <div class="forecast-date">${dayName}</div>
                            <div class="forecast-icon">${icon}</div>
                            <div class="forecast-temp">${maxTemp}¬∞/${minTemp}¬∞</div>
                            ${snow > 0 ? `<div class="forecast-snow">‚ùÑÔ∏è ${Math.round(snow)}cm</div>` : ''}
                        </div>
                    `;
                }).join('');
                
                return `
                    <div class="weather-widget">
                        <div class="weather-current">
                            <div>
                                <div class="weather-temp">${Math.round(current.temperature)}¬∞C</div>
                                <div class="weather-info">
                                    üí® ${Math.round(current.windspeed)} km/h
                                </div>
                            </div>
                            <div class="weather-icon">
                                ${this.getWeatherIcon(current.weathercode)}
                            </div>
                        </div>
                        ${nebelStatus ? `
                            <div class="nebel-status ${nebelStatus.class}">
                                ${nebelStatus.text}
                            </div>
                        ` : ''}
                        <div style="margin-top: 10px; font-weight: 600; font-size: 0.8em;">
                            üìÖ 7-Tage Vorhersage
                        </div>
                        <div class="weather-forecast">
                            ${forecastHTML}
                        </div>
                    </div>
                `;
            },
            
            createNavigationBox(loipe) {
                const startPLZ = document.getElementById('plz-input').value || '8824';
                const travelTime = this.calculateTravelTime(loipe.anfahrt_km);
                const googleMapsLink = this.generateGoogleMapsLink(loipe, startPLZ);
                const appleMapsLink = this.generateAppleMapsLink(loipe, startPLZ);
                
                if (!loipe.anfahrt_km) {
                    return '<div class="navigation-box"><div style="text-align: center; opacity: 0.7; font-size: 0.8em;">Keine Anfahrtsdaten</div></div>';
                }
                
                return `
                    <div class="navigation-box">
                        <div class="nav-title">üß≠ Anfahrt</div>
                        <div class="nav-details">
                            <div class="nav-item">
                                <span class="nav-icon">üöó</span>
                                <div class="nav-value">
                                    <span class="nav-label">Distanz</span>
                                    <span class="nav-number">${loipe.anfahrt_km} km</span>
                                </div>
                            </div>
                            <div class="nav-item">
                                <span class="nav-icon">‚è±Ô∏è</span>
                                <div class="nav-value">
                                    <span class="nav-label">Fahrzeit</span>
                                    <span class="nav-number">${travelTime || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                        <div class="nav-buttons">
                            <a href="${googleMapsLink}" target="_blank" class="nav-btn primary">
                                üìç Google
                            </a>
                            <a href="${appleMapsLink}" target="_blank" class="nav-btn">
                                üçé Apple
                            </a>
                        </div>
                    </div>
                `;
            },
            
            createSchneehoheBox(schneehoehe) {
                if (!schneehoehe) return '';
                
                let status = '';
                let statusClass = '';
                
                if (schneehoehe >= 80) {
                    status = 'Ausgezeichnet';
                    statusClass = 'status-gut';
                } else if (schneehoehe >= 40) {
                    status = 'Gut';
                    statusClass = 'status-mittel';
                } else if (schneehoehe >= 20) {
                    status = 'Knapp';
                    statusClass = 'status-schlecht';
                } else {
                    status = 'Wenig';
                    statusClass = 'status-schlecht';
                }
                
                return `
                    <div class="schneehoehe-box">
                        <strong>‚ùÑÔ∏è Schneeh√∂he</strong>
                        <div class="schnee-detail">
                            <span>Aktuell:</span>
                            <span style="font-weight: 700;">${schneehoehe} cm</span>
                        </div>
                        <div class="schnee-detail">
                            <span>Status:</span>
                            <span class="status-badge ${statusClass}" style="margin: 0; padding: 2px 6px;">
                                ${status}
                            </span>
                        </div>
                    </div>
                `;
            },
            
            loadData() {
                const data = generateMockLoipenData();
                this.loipenData = data.loipen;
                
                this.updateStatistics(data);
                this.initializeRegionFilter();
                this.loadFavorites();
                this.filterLoipen();
            },
            
            initializeRegionFilter() {
                const regionen = [...new Set(this.loipenData.map(l => l.region || 'Unbekannt'))].sort();
                const container = document.getElementById('region-tags');
                
                container.innerHTML = '';
                
                const alleTag = document.createElement('div');
                alleTag.className = 'region-tag active';
                alleTag.textContent = 'Alle';
                alleTag.onclick = () => {
                    this.activeRegions.clear();
                    document.querySelectorAll('.region-tag').forEach(tag => {
                        tag.classList.remove('active');
                    });
                    alleTag.classList.add('active');
                    this.filterLoipen();
                };
                container.appendChild(alleTag);
                
                regionen.forEach(region => {
                    const tag = document.createElement('div');
                    tag.className = 'region-tag';
                    tag.textContent = region;
                    tag.onclick = () => {
                        alleTag.classList.remove('active');
                        
                        if (this.activeRegions.has(region)) {
                            this.activeRegions.delete(region);
                            tag.classList.remove('active');
                        } else {
                            this.activeRegions.add(region);
                            tag.classList.add('active');
                        }
                        
                        if (this.activeRegions.size === 0) {
                            alleTag.classList.add('active');
                        }
                        
                        this.filterLoipen();
                    };
                    container.appendChild(tag);
                });
            },
            
            updateStatistics(data) {
                const loipen = data.loipen || data;
                
                document.getElementById('total-loipen').textContent = loipen.length;
                
                const totalKm = loipen.reduce((sum, l) => sum + (l.distanz_km || 0), 0);
                document.getElementById('total-km').textContent = Math.round(totalKm);
                
                const regionen = new Set(loipen.map(l => l.region || 'Unbekannt'));
                document.getElementById('total-regionen').textContent = regionen.size;
                
                const loipenMitAnfahrt = loipen.filter(l => l.anfahrt_km);
                const avgDistance = loipenMitAnfahrt.length > 0
                    ? Math.round(loipenMitAnfahrt.reduce((sum, l) => sum + l.anfahrt_km, 0) / loipenMitAnfahrt.length)
                    : 0;
                document.getElementById('avg-distance').textContent = avgDistance;
                
                if (data.scraping_datum) {
                    document.getElementById('last-update').textContent = 
                        new Date(data.scraping_datum).toLocaleDateString('de-CH', { day: '2-digit', month: '2-digit' });
                }
            },
            
            filterLoipen() {
                const maxDistanz = parseFloat(document.getElementById('distanz-slider').value);
                const maxAnfahrt = parseFloat(document.getElementById('anfahrt-slider').value);
                const maxHoehenmeter = parseFloat(document.getElementById('hoehenmeter-slider').value);
                const maxUpdateDays = parseInt(document.getElementById('update-slider').value);
                const minSchneehoehe = parseInt(document.getElementById('schnee-slider').value);
                const searchText = document.getElementById('search-input').value.toLowerCase();
                
                const klassisch = document.getElementById('klassisch').checked;
                const skating = document.getElementById('skating').checked;
                const gut = document.getElementById('gut').checked;
                const mittel = document.getElementById('mittel').checked;
                const geschlossen = document.getElementById('geschlossen').checked;
                
                const leicht = document.getElementById('schwier-leicht').checked;
                const schwierMittel = document.getElementById('schwier-mittel').checked;
                const schwer = document.getElementById('schwier-schwer').checked;
                
                const wetterSonnig = document.getElementById('wetter-sonnig').checked;
                const wetterSchnee = document.getElementById('wetter-schnee').checked;
                const wetterBewoelkt = document.getElementById('wetter-bewoelkt').checked;
                
                const today = new Date();
                const maxUpdateDate = new Date(today.getTime() - maxUpdateDays * 24 * 60 * 60 * 1000);
                
                this.filteredData = this.loipenData.filter(loipe => {
                    if (this.activeRegions.size > 0 && !this.activeRegions.has(loipe.region)) {
                        return false;
                    }
                    
                    if (loipe.distanz_km > maxDistanz) return false;
                    if (loipe.anfahrt_km && loipe.anfahrt_km > maxAnfahrt) return false;
                    
                    const hoehe = loipe.hoehenprofil?.aufstieg || loipe.hoehenmeter || 0;
                    if (hoehe > maxHoehenmeter) return false;
                    
                    if (loipe.schneehoehe && loipe.schneehoehe < minSchneehoehe) return false;
                    
                    if (loipe.wetter_kategorie) {
                        if (loipe.wetter_kategorie === 'sonnig' && !wetterSonnig) return false;
                        if (loipe.wetter_kategorie === 'schnee' && !wetterSchnee) return false;
                        if (loipe.wetter_kategorie === 'bewoelkt' && !wetterBewoelkt) return false;
                    }
                    
                    if (loipe.letztes_update) {
                        const updateDate = new Date(loipe.letztes_update);
                        if (updateDate < maxUpdateDate) return false;
                    }
                    
                    if (searchText) {
                        const searchString = `${loipe.name} ${loipe.ort} ${loipe.region}`.toLowerCase();
                        if (!searchString.includes(searchText)) return false;
                    }
                    
                    const hatKlassisch = loipe.technik.includes('Klassisch');
                    const hatSkating = loipe.technik.includes('Skating');
                    if (!klassisch && hatKlassisch && !hatSkating) return false;
                    if (!skating && hatSkating && !hatKlassisch) return false;
                    if (!klassisch && !skating) return false;
                    
                    const zustandLower = loipe.zustand.toLowerCase();
                    if (zustandLower.includes('gut') || zustandLower.includes('gespurt')) {
                        if (!gut) return false;
                    }
                    if (zustandLower.includes('mittel') || zustandLower.includes('befahrbar')) {
                        if (!mittel) return false;
                    }
                    if (zustandLower.includes('geschlossen') || zustandLower.includes('nicht')) {
                        if (!geschlossen) return false;
                    }
                    
                    if (loipe.schwierigkeit) {
                        const schwierigkeitLower = loipe.schwierigkeit.toLowerCase();
                        if (schwierigkeitLower.includes('leicht') && !leicht) return false;
                        if (schwierigkeitLower.includes('mittel') && !schwierMittel) return false;
                        if (schwierigkeitLower.includes('schwer') && !schwer) return false;
                    }
                    
                    return true;
                });
                
                this.sortAndDisplay(this.filteredData);
                this.updateFavoritesDisplay();
            },
            
            sortAndDisplay(loipen) {
                const sortBy = document.getElementById('sort-select').value;
                
                const sorted = [...loipen].sort((a, b) => {
                    switch(sortBy) {
                        case 'name':
                            return a.name.localeCompare(b.name);
                        case 'anfahrt':
                            return (a.anfahrt_km || 999) - (b.anfahrt_km || 999);
                        case 'distanz':
                            return (b.distanz_km || 0) - (a.distanz_km || 0);
                        case 'hoehe':
                            const hoeheA = a.hoehenprofil?.aufstieg || a.hoehenmeter || 0;
                            const hoeheB = b.hoehenprofil?.aufstieg || b.hoehenmeter || 0;
                            return hoeheB - hoeheA;
                        case 'region':
                            return (a.region || '').localeCompare(b.region || '');
                        case 'update':
                            return new Date(b.letztes_update || 0) - new Date(a.letztes_update || 0);
                        default:
                            return 0;
                    }
                });
                
                this.displayLoipen(sorted);
            },
            
            async displayLoipen(loipen) {
                const container = document.getElementById('loipen-container');
                const noResults = document.getElementById('no-results');
                const resultsCount = document.getElementById('results-count');
                
                resultsCount.textContent = loipen.length;
                
                if (loipen.length === 0) {
                    container.style.display = 'none';
                    noResults.style.display = 'block';
                    return;
                }
                
                container.style.display = 'grid';
                noResults.style.display = 'none';
                
                container.innerHTML = loipen.map(loipe => this.createLoipeCard(loipe, null)).join('');
                
                container.querySelectorAll('.favorite-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        const loipeId = e.currentTarget.getAttribute('data-loipe-id');
                        this.toggleFavorite(loipeId);
                    });
                });
                
                const loipenMitKoordinaten = loipen.filter(l => l.latitude && l.longitude).slice(0, 20);
                
                for (const loipe of loipenMitKoordinaten) {
                    const weatherHTML = await this.createWeatherWidget(loipe);
                    const cardId = `loipe-${this.getLoipeId(loipe)}`;
                    const card = document.getElementById(cardId);
                    if (card) {
                        const weatherContainer = card.querySelector('.weather-container');
                        if (weatherContainer) {
                            weatherContainer.innerHTML = weatherHTML;
                        }
                    }
                }
            },
            
            createLoipeCard(loipe, weatherHTML) {
                const loipeId = this.getLoipeId(loipe);
                const isFavorite = this.favorites.has(loipeId);
                
                return `
                    <div class="loipe-card ${isFavorite ? 'favorite' : ''}" id="loipe-${loipeId}">
                        <div class="loipe-header">
                            <button class="favorite-btn ${isFavorite ? 'active' : ''}" 
                                    data-loipe-id="${loipeId}">
                                ${isFavorite ? '‚≠ê' : '‚òÜ'}
                            </button>
                            <div class="loipe-name">${loipe.name}</div>
                            ${loipe.link ? `
                                <a href="${loipe.link}" target="_blank" class="loipe-link">
                                    üîó Bergfex
                                </a>
                            ` : ''}
                            <div class="loipe-location">
                                üìç ${loipe.ort}
                                ${loipe.region ? `<span class="region-badge">${loipe.region}</span>` : ''}
                            </div>
                            ${loipe.letztes_update ? `
                                <div class="last-update">
                                    üìÖ ${this.formatDate(loipe.letztes_update)}
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="loipe-details">
                            <div class="detail-item">
                                <span class="detail-icon">üìè</span>
                                <span class="detail-value">${loipe.distanz_km} km</span>
                            </div>
                            ${loipe.hoehenmeter || loipe.hoehenprofil?.aufstieg ? `
                            <div class="detail-item">
                                <span class="detail-icon">‚õ∞Ô∏è</span>
                                <span class="detail-value">${loipe.hoehenprofil?.aufstieg || loipe.hoehenmeter} Hm</span>
                            </div>
                            ` : ''}
                        </div>
                        
                        ${this.createWebcamWidget(loipe)}
                        
                        ${this.createNavigationBox(loipe)}
                        
                        ${this.createSchneehoheBox(loipe.schneehoehe)}
                        
                        <div class="weather-container">
                            ${weatherHTML || '<div class="weather-loading">‚è≥ Lade Wetter...</div>'}
                        </div>
                        
                        ${loipe.hoehenprofil && loipe.hoehenprofil.max_hoehe ? `
                        <div class="hoehenprofil-box">
                            <strong>üìä H√∂henprofil</strong>
                            <div class="hoehen-detail">
                                <span>Min/Max:</span>
                                <span>${loipe.hoehenprofil.min_hoehe}m - ${loipe.hoehenprofil.max_hoehe}m</span>
                            </div>
                            ${loipe.hoehenprofil.aufstieg ? `
                            <div class="hoehen-detail">
                                <span>Aufstieg:</span>
                                <span>${loipe.hoehenprofil.aufstieg} Hm</span>
                            </div>
                            ` : ''}
                        </div>
                        ` : ''}
                        
                        ${loipe.beschreibung ? `
                        <div class="beschreibung">
                            ${loipe.beschreibung}
                        </div>
                        ` : ''}
                        
                        <div>
                            <span class="status-badge ${this.getStatusClass(loipe.zustand)}">
                                ${loipe.zustand}
                            </span>
                            ${loipe.schwierigkeit ? `
                            <span class="status-badge difficulty-${loipe.schwierigkeit.toLowerCase()}">
                                ${loipe.schwierigkeit}
                            </span>
                            ` : ''}
                        </div>
                        
                        <div class="technik-badges">
                            ${loipe.technik.map(t => `<span class="technik-badge">${t}</span>`).join('')}
                        </div>
                        
                        ${loipe.besonderheiten && loipe.besonderheiten.length > 0 ? `
                        <div class="besonderheiten">
                            ${loipe.besonderheiten.map(b => `<span class="besonderheit-tag">${b}</span>`).join('')}
                        </div>
                        ` : ''}
                    </div>
                `;
            },
            
            getStatusClass(zustand) {
                const z = zustand.toLowerCase();
                if (z.includes('gut') || z.includes('gespurt') || z.includes('ge√∂ffnet')) return 'status-gut';
                if (z.includes('mittel') || z.includes('befahrbar')) return 'status-mittel';
                if (z.includes('geschlossen') || z.includes('nicht')) return 'status-schlecht';
                return 'status-unbekannt';
            },
            
            formatDate(dateString) {
                if (!dateString) return '-';
                const date = new Date(dateString);
                return date.toLocaleDateString('de-CH', { 
                    day: '2-digit',
                    month: '2-digit',
                    year: '2-digit'
                });
            }
        };
        
        // Event Listeners
        document.getElementById('distanz-slider').addEventListener('input', function() {
            document.getElementById('distanz-value').textContent = this.value;
            window.loipenApp.filterLoipen();
        });
        
        document.getElementById('anfahrt-slider').addEventListener('input', function() {
            document.getElementById('anfahrt-value').textContent = this.value;
            window.loipenApp.filterLoipen();
        });
        
        document.getElementById('hoehenmeter-slider').addEventListener('input', function() {
            document.getElementById('hoehenmeter-value').textContent = this.value;
            window.loipenApp.filterLoipen();
        });
        
        document.getElementById('update-slider').addEventListener('input', function() {
            document.getElementById('update-value').textContent = this.value;
            window.loipenApp.filterLoipen();
        });
        
        document.getElementById('schnee-slider').addEventListener('input', function() {
            document.getElementById('schnee-value').textContent = this.value;
            window.loipenApp.filterLoipen();
        });
        
        document.getElementById('search-input').addEventListener('input', () => window.loipenApp.filterLoipen());
        document.getElementById('klassisch').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('skating').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('gut').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('mittel').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('geschlossen').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('schwier-leicht').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('schwier-mittel').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('schwier-schwer').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('wetter-sonnig').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('wetter-schnee').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('wetter-bewoelkt').addEventListener('change', () => window.loipenApp.filterLoipen());
        document.getElementById('sort-select').addEventListener('change', () => {
            window.loipenApp.sortAndDisplay(window.loipenApp.filteredData);
        });
        
        // Webcam Auto-Refresh alle 5 Minuten (nur Header-Webcams)
        setInterval(() => {
            const webcams = document.querySelectorAll('header .webcam-item img');
            webcams.forEach(img => {
                const src = img.src;
                img.src = src.split('?')[0] + '?t=' + new Date().getTime();
            });
        }, 5 * 60 * 1000);
        
        // Initial laden
        window.addEventListener('DOMContentLoaded', () => {
            createSnowflakes();
            window.loipenApp.loadData();
        });
    </script>
</body>
</html>

							<script>
                            	
							</script>
                        </body>
                        </html>
                    